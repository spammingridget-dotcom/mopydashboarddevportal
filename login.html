<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mopy Developmentz â€” Login</title>
  <link rel="stylesheet" href="style.css">

  <!-- bcrypt in browser to verify stored bcrypt hashes -->
  <script src="https://cdn.jsdelivr.net/npm/bcryptjs@2.4.3/dist/bcrypt.min.js"></script>
  <!-- Supabase client -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="app.js" defer></script>
</head>
<body>
  <main class="center-card">
    <h2>Developer Login</h2>

    <label class="field">
      <span>Username</span>
      <input id="username" autocomplete="username" placeholder="username">
    </label>

    <label class="field">
      <span>Password</span>
      <input id="password" type="password" autocomplete="current-password" placeholder="password">
    </label>

    <div style="margin-top:12px;">
      <button class="btn primary" id="signInBtn">Sign in</button>
      <a class="btn ghost" href="index.html">Back</a>
    </div>

    <div id="error" class="err" role="alert" aria-live="polite"></div>

    <p class="note">Contact <strong>Mopy_UGC</strong> on Discord if you need help.</p>
  </main>

  <script>
    // On load attach sign-in
    document.getElementById('signInBtn').addEventListener('click', async () => {
      const u = document.getElementById('username').value.trim();
      const p = document.getElementById('password').value;
      const err = document.getElementById('error');
      err.textContent = '';

      if(!u || !p){ err.textContent = "Fill both fields."; return; }

      try {
        // use function from app.js
        await window.mopyAuth.signInWithCredentials(u, p);
        // redirect to dashboard
        window.location.href = 'dashboard.html';
      } catch(e) {
        err.textContent = e.message || 'Login failed';
      }
    });
  </script>
</body>
</html>
